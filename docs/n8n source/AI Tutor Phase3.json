{
  "name": "AI Tutor Phase3",
  "nodes": [
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {}
      },
      "id": "f5891c55-f2f2-4ad7-9b8a-890253da7dc6",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1,
      "position": [
        4416,
        1120
      ],
      "credentials": {
        "openAiApi": {
          "id": "FHruXiW3PJfYtsIQ",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Agent Tools for RAG",
        "height": 465,
        "width": 967,
        "color": 4
      },
      "id": "58c3e9fc-db57-4e8a-adb9-5fee33e1917c",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        3328,
        1296
      ]
    },
    {
      "parameters": {
        "content": "## RAG AI Agent with Chat Interface",
        "height": 817,
        "width": 2908
      },
      "id": "66e00ff3-c701-4420-af31-609a04d38d39",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        3024,
        464
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {}
      },
      "id": "1911a910-16d6-486c-afc9-b10c23bc9358",
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        4992,
        896
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "6350e749-78cb-4a00-890d-cfa59faafac8",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "1abc4356-6798-4a69-b63f-c134a79a7743",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        3104,
        880
      ],
      "webhookId": "6350e749-78cb-4a00-890d-cfa59faafac8"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Webhook').item.json.body.message }}",
        "options": {
          "systemMessage": "=ë‹¹ì‹ ì€ í•œêµ­ ì¤‘ê³ ë“±í•™ìƒì„ ìœ„í•œ AI ìˆ˜í•™ íŠœí„°ì…ë‹ˆë‹¤.\n\n## ì‚¬ìš©ì ì •ë³´ (ê¸°ì–µ)\n{{ $('Mem0 Search').item.json.results.map(r => '- ' + r.memory).join('\\n') }}\n\nìœ„ ê¸°ì–µì— ë‚˜ì˜¨ í•™ìƒì˜ êµ¬ì²´ì ì¸ ì•½ì ê³¼ ë°˜ë³µ ì‹¤ìˆ˜ë¥¼ ë°˜ë“œì‹œ ëª…ì‹œì ìœ¼ë¡œ ì–¸ê¸‰í•˜ê³ ,\nì´ ë¬¸ì œì˜ ì–´ë–¤ ê³„ì‚° ë‹¨ê³„ì—ì„œ í•´ë‹¹ ì‹¤ìˆ˜ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ê²½ê³ í•˜ë¼.\nê¸°ì–µì´ ì—†ìœ¼ë©´ ì¼ë°˜ì ìœ¼ë¡œ ë‹µí•˜ë¼.\n\n## ê´€ë ¨ ë¬¸ì œì€í–‰ ë ˆí¼ëŸ°ìŠ¤ (ìë™ ê²€ìƒ‰ ê²°ê³¼)\n{{ $('Aggregate').item.json.document.map(d => d.pageContent).join('\\n---\\n') }}\nìœ„ ë ˆí¼ëŸ°ìŠ¤ì—ì„œ ìœ ì‚¬í•œ ë¬¸ì œë¥¼ ì—°ìŠµë¬¸ì œë¡œ ì¶”ì²œí•˜ë¼. ë¬¸ì œ ì½”ë“œ(QE-001 ë“±)ë¥¼ ë°˜ë“œì‹œ í¬í•¨í•˜ë¼.\n\n## ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬\n1. **wolfram_calculator** - ìˆ˜í•™ ê³„ì‚° ê²€ì¦ (ëª¨ë“  í’€ì´ì—ì„œ ë°˜ë“œì‹œ ì‚¬ìš©)\n2. **Supabase Vector Store** - ë¬¸ì œì€í–‰ì—ì„œ ì¶”ê°€ ê²€ìƒ‰ì´ í•„ìš”í•  ë•Œ ì‚¬ìš©\n3. **List Documents** - ë¬¸ì œì€í–‰ ëª©ë¡ í™•ì¸\n4. **Get File Contents** - íŠ¹ì • ë¬¸ì œì˜ ìƒì„¸ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°\n5. **List Tables Get Table Schema** - í…Œì´ë¸” êµ¬ì¡° í™•ì¸\n6. **Execute SQL** - ë¬¸ì œ ë°ì´í„° ì¡°íšŒ (SELECTë§Œ ê°€ëŠ¥)\n\n## í•„ìˆ˜ ê·œì¹™\nâš ï¸ 1. í’€ì´ ì™„ë£Œ í›„ ë°˜ë“œì‹œ wolfram_calculatorë¡œ ìµœì¢…ë‹µì„ ê²€ì¦í•˜ë¼. ê²°ê³¼ê°€ ë‹¤ë¥´ë©´ ì¦‰ì‹œ ìˆ˜ì •.\nâš ï¸ 2. ì—°ìŠµë¬¸ì œ ì¶”ì²œ ì‹œ ë°˜ë“œì‹œ ìœ„ ë¬¸ì œì€í–‰ ë ˆí¼ëŸ°ìŠ¤ì—ì„œ ì„ íƒí•˜ë¼. ì§ì ‘ ë§Œë“¤ì§€ ë§ˆë¼.\nâš ï¸ 3. ë‹µì„ ì°¾ì§€ ëª»í•˜ë©´ ì†”ì§í•˜ê²Œ ë§í•˜ë¼. ì ˆëŒ€ ì§€ì–´ë‚´ì§€ ë§ˆë¼.\n\n## ì¶œë ¥ í˜•ì‹ (ë°˜ë“œì‹œ ì§€ì¼œë¼)\n1) ìµœì¢…ë‹µ: (ì§§ê²Œ)\n2) í’€ì´ ë‹¨ê³„(4ë‹¨ê³„ ê³ ì •):\n   - 1ë‹¨ê³„(ì „ëµ ì„ íƒ): ...\n   - 2ë‹¨ê³„(í•µì‹¬ ì•„ì´ë””ì–´): ...\n   - 3ë‹¨ê³„(ê³„ì‚° ì „ê°œ): ...\n   - 4ë‹¨ê³„(ê²€ì‚° ë° ì •ë¦¬): ...\n3) ì²´í¬í¬ì¸íŠ¸ ì§ˆë¬¸(2ê°œ):\n4) ì‹¤ìˆ˜ ë°©ì§€ ì£¼ì˜ì‚¬í•­(í•™ìƒ ì•½ì  ê¸°ë°˜, êµ¬ì²´ì ìœ¼ë¡œ):\n5) ì—°ìŠµë¬¸ì œ ì¶”ì²œ(2ê°œ, ë¬¸ì œì€í–‰ ë ˆí¼ëŸ°ìŠ¤ì—ì„œ ì„ íƒ, ë¬¸ì œ ì½”ë“œ í¬í•¨):\n\ní•œêµ­ì–´ë¡œ ë‹µë³€í•˜ì„¸ìš”."
        }
      },
      "id": "e95f959f-6e60-4ede-bdd9-35a10ea7fc26",
      "name": "RAG AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.6,
      "position": [
        4640,
        896
      ]
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "ë¬¸ì œì€í–‰ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤. ë¬¸ì œ ì½”ë“œ, ê³¼ëª©, í† í”½, ë‚œì´ë„, ì •ë‹µ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "document_metadata",
          "mode": "list",
          "cachedResultName": "document_metadata"
        },
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.postgresTool",
      "typeVersion": 2.5,
      "position": [
        4704,
        1120
      ],
      "id": "6057a017-9466-49b4-8dd4-691efe77279a",
      "name": "List Documents",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "íŠ¹ì • ë¬¸ì œì˜ ì „ì²´ í’€ì´ í•´ì„¤ í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. file_idë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
        "operation": "executeQuery",
        "query": "SELECT \n    string_agg(content, ' ') as document_text\nFROM documents\nWHERE metadata->>'file_id' LIKE $1 || '%'\nGROUP BY metadata->>'file_id';",
        "options": {
          "queryReplacement": "={{ $fromAI('file_id') }}"
        }
      },
      "type": "n8n-nodes-base.postgresTool",
      "typeVersion": 2.5,
      "position": [
        4848,
        1120
      ],
      "id": "362e182a-a326-4071-8215-4a8c5e5cd915",
      "name": "Get File Contents",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "content": "ë‹¹ì‹ ì€ ë¬¸ì„œ ê¸°ë°˜ ì§ˆë¬¸ì— ë‹µë³€í•˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.\n\n## ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬\n1. **RAG ê²€ìƒ‰** (documents í…Œì´ë¸”) - ë¬¸ì„œ ë‚´ìš© ì˜ë¯¸ ê²€ìƒ‰\n2. **ë¬¸ì„œ ëª©ë¡ ì¡°íšŒ** (document_metadata í…Œì´ë¸”) - ì–´ë–¤ ë¬¸ì„œë“¤ì´ ìˆëŠ”ì§€ í™•ì¸\n3. **ë¬¸ì„œ ì „ì²´ í…ìŠ¤íŠ¸ ì¶”ì¶œ** - íŠ¹ì • ë¬¸ì„œì˜ ì „ì²´ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°\n4. **SQL ì¿¼ë¦¬** (document_rows í…Œì´ë¸”) - CSV/Excel ë“± í‘œ í˜•ì‹ ë°ì´í„° ì¡°íšŒ\n\n## ì‘ë‹µ ì „ëµ\n1. **ì¼ë°˜ ì§ˆë¬¸** â†’ RAG ê²€ìƒ‰ë¶€í„° ì‹œì‘\n2. **ìˆ˜ì¹˜/ì§‘ê³„ ì§ˆë¬¸** (í•©ê³„, ìµœëŒ€ê°’ ë“±) â†’ SQL ì¿¼ë¦¬ ì‚¬ìš©\n3. **RAGë¡œ ë‹µ ëª» ì°¾ìœ¼ë©´** â†’ document_metadataì—ì„œ ê´€ë ¨ ë¬¸ì„œ ì°¾ì•„ì„œ ì „ì²´ ë¶„ì„\n4. **ê·¸ë˜ë„ ëª» ì°¾ìœ¼ë©´** â†’ ì†”ì§í•˜ê²Œ \"ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤\" ë‹µë³€\n\n## ì£¼ì˜ì‚¬í•­\n- ë‹µì„ ëª¨ë¥´ë©´ ì ˆëŒ€ ì§€ì–´ë‚´ì§€ ë§ˆì„¸ìš”\n- ì¶œì²˜ ë¬¸ì„œëª…ì„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”\n- í•œêµ­ì–´ë¡œ ì¹œì ˆí•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”",
        "height": 400,
        "width": 480
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5952,
        464
      ],
      "typeVersion": 1,
      "id": "21e32a22-f4c5-46d2-81b0-de108833b2b5",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "ë¬¸ì œì€í–‰ ë°ì´í„°ë¥¼ SQLë¡œ ì¡°íšŒí•©ë‹ˆë‹¤. SELECTë§Œ ê°€ëŠ¥. ì˜ˆ: íŠ¹ì • í† í”½/ë‚œì´ë„ ë¬¸ì œ í•„í„°ë§.",
        "operation": "executeQuery",
        "query": "{{ $fromAI('sql_query') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.postgresTool",
      "typeVersion": 2.5,
      "position": [
        5008,
        1120
      ],
      "id": "8818a577-483f-4c3f-9db6-4c96ecb72ac9",
      "name": "Execute SQL",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸” ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤. SQL ì§ˆë¬¸ì„ ë°›ìœ¼ë©´ í•­ìƒ ì´ ë„êµ¬ë¥¼ ë¨¼ì € ì‚¬ìš©í•˜ì„¸ìš”.",
        "operation": "executeQuery",
        "query": "SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_type = 'BASE TABLE';",
        "options": {}
      },
      "type": "n8n-nodes-base.postgresTool",
      "typeVersion": 2.5,
      "position": [
        5120,
        1120
      ],
      "id": "85800e5a-23f3-4651-84e1-61b0e024267c",
      "name": "List Tables",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "íŠ¹ì • í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ì •ë³´ì™€ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. SQL ì¿¼ë¦¬ ì‘ì„± ì „ì— í…Œì´ë¸” êµ¬ì¡°ë¥¼ í™•ì¸í•  ë•Œ ì‚¬ìš©í•˜ì„¸ìš”.",
        "operation": "executeQuery",
        "query": "SELECT column_name, data_type, is_nullable \nFROM information_schema.columns \nWHERE table_name = $1\nORDER BY ordinal_position;",
        "options": {
          "queryReplacement": "={{ $fromAI('Query_Parameters', ``, 'string') }}"
        }
      },
      "type": "n8n-nodes-base.postgresTool",
      "typeVersion": 2.5,
      "position": [
        5248,
        1120
      ],
      "id": "72de65a4-63c3-4b1b-98ac-7c03570ae51a",
      "name": "Get Table Schema",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://193.168.195.222:8888/search",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"query\": \"{{ $('Webhook').first().json.body.message }}\",\n  \"user_id\": \"{{ $('Webhook').first().json.body.user_id }}\",\n  \"limit\": 5\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3856,
        896
      ],
      "id": "35970400-40a9-42d6-8e8b-e79da1ad2df1",
      "name": "Mem0 Search"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://193.168.195.222:8888/memories",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": {{ JSON.stringify($('Memory Summary').item.json.output.summary) }}\n    }\n  ],\n  \"user_id\": \"{{ $('Webhook').item.json.body.user_id }}\",\n  \"agent_id\": \"lqpagent\",\n  \"run_id\": \"pocmem0001\",\n  \"infer\": false,\n  \"metadata\": {\n    \"source\": \"n8n\",\n    \"memory_type\": \"{{ $('Evaluate').item.json.output.memory_type }}\",\n    \"confidence\": {{ $('Evaluate').item.json.output.confidence }},\n    \"eval_reason\": {{ JSON.stringify($('Evaluate').item.json.output.reason) }},\n    \"origin\": \"conversation_summary\",\n    \"decision\": {{ JSON.stringify($('Memory Summary').item.json.output.decision || '') }},\n    \"relations\": {{ JSON.stringify($('Memory Summary').item.json.output.relations || []) }},\n    \"timestamp\": \"{{ $now.toISO() }}\"\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        6336,
        880
      ],
      "id": "59fa4736-78b8-4271-9b35-2cd2f3fad12d",
      "name": "Mem0 Add",
      "retryOnFail": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ì‚¬ìš©ì: {{ $('Webhook').item.json.body.message }}\nAI ì‘ë‹µ: {{ $if($('RAG AI Agent').isExecuted, $('RAG AI Agent').item.json.output, $('Assignment Agent').item.json.output) }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=ë„ˆëŠ” AI ìˆ˜í•™ íŠœí„°ì˜ í•™ìŠµ ê¸°ì–µ ì—”ì§„ì´ë‹¤.\ní•™ìƒì˜ í’€ì´ ê³¼ì •ê³¼ AI ì‘ë‹µì„ ë³´ê³ , ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•™ìŠµ ê¸°ì–µë§Œ ì¶”ì¶œí•˜ë¼.\n\nâš ï¸ í•µì‹¬: ì¶”ìƒì ìœ¼ë¡œ ì“°ì§€ ë§ˆë¼. ë°˜ë“œì‹œ êµ¬ì²´ì ìœ¼ë¡œ ì¨ë¼.\n\n[ì¢‹ì€ ì˜ˆì‹œ - êµ¬ì²´ì ]\n- \"íŒë³„ì‹ D = bÂ²-4acì—ì„œ cê°€ ìŒìˆ˜ì¼ ë•Œ -4ac ë¶€í˜¸ë¥¼ ìì£¼ í‹€ë¦¼. -4(1)(-3)ì„ -12ë¡œ ê³„ì‚°í•˜ëŠ” ì‹¤ìˆ˜ ë°˜ë³µ\"\n- \"ê·¼ì˜ ê³µì‹ ì„ í˜¸. ì¸ìˆ˜ë¶„í•´ ê°€ëŠ¥í•œ ë¬¸ì œë„ ê·¼ì˜ ê³µì‹ìœ¼ë¡œ í’€ë ¤ëŠ” ê²½í–¥\"\n- \"ê²€ì‚° ë‹¨ê³„ë¥¼ ê±´ë„ˆëœ€. í•´ë¥¼ ì›ë˜ ë°©ì •ì‹ì— ëŒ€ì…í•˜ëŠ” ìŠµê´€ ì—†ìŒ\"\n\n[ë‚˜ìœ ì˜ˆì‹œ - ì¶”ìƒì ]\n- \"ë¶€í˜¸ ì‹¤ìˆ˜ê°€ ìˆìŒ\"\n- \"ê³„ì‚° ì‹¤ìˆ˜ ì£¼ì˜ í•„ìš”\"\n- \"ê²€ì‚° ë¶€ì¡±\"\n\n[ì¶”ì¶œ í•­ëª©]\n1. ì–´ë–¤ ê°œë…/ê³µì‹ì—ì„œ ì‹¤ìˆ˜í•˜ëŠ”ê°€ (êµ¬ì²´ì  ê³µì‹ëª…)\n2. ì‹¤ìˆ˜ì˜ ì •í™•í•œ íŒ¨í„´ (ì–´ë–¤ ê°’ì„ ì–´ë–»ê²Œ í‹€ë¦¬ëŠ”ê°€)\n3. í•™ìƒì˜ í’€ì´ ì „ëµ ì„ í˜¸ (ì¸ìˆ˜ë¶„í•´ vs ê·¼ì˜ê³µì‹ ë“±)\n4. ëˆ„ë½í•˜ëŠ” ë‹¨ê³„ (ê²€ì‚°, ì¡°ê±´ í™•ì¸ ë“±)\n\n[ì €ì¥ ê¸ˆì§€]\n- ë¬¸ì œ í’€ì´ ê³¼ì • ìì²´ (ì •ë‹µ/í’€ì´ ë‚´ìš©)\n- AI íŠœí„°ì˜ ì„¤ëª…/ì œì•ˆ ë‚´ìš©\n- AIê°€ ì‚¬ìš©í•œ ë„êµ¬ (Wolfram ë“±)\n- ë‹¨ìˆœ ì •ë‹µ/ì˜¤ë‹µ ì—¬ë¶€ë§Œ\n- íŠ¹ì • ë¬¸ì œì˜ ê³„ìˆ˜ ì˜ˆì‹œ (a=2, b=5 ê°™ì€ ê²ƒ)\n\nâš ï¸ ì ˆëŒ€ ê·œì¹™:\n- ë°˜ë“œì‹œ JSONë§Œ ì¶œë ¥í•˜ë¼. ì„¤ëª…, ë§ˆí¬ë‹¤ìš´, ì½”ë“œë¸”ë¡ ê¸ˆì§€.\n- ì €ì¥í•  ë‚´ìš©ì´ ì—†ìœ¼ë©´ ë°˜ë“œì‹œ ì´ JSONì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ë¼:\n{\"summary\": \"\", \"decision\": \"\", \"relations\": []}\n\nì¶œë ¥ í˜•ì‹:\n{\n  \"summary\": \"êµ¬ì²´ì  ì•½ì  ìš”ì•½ (ê³µì‹ëª…+ì‹¤ìˆ˜íŒ¨í„´+ì˜ˆì‹œ í¬í•¨) ë˜ëŠ” ë¹ˆ ë¬¸ìì—´\",\n  \"decision\": \"í•µì‹¬ ì•½ì  íŒ¨í„´\",\n  \"relations\": [\"ê´€ê³„ ìš”ì•½\"]\n}"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        5456,
        896
      ],
      "id": "1717c244-3fe4-496d-99fe-0233055c7135",
      "name": "Memory Summary"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        5776,
        1120
      ],
      "id": "1857814c-d4eb-4bed-968f-3d86788c6ce9",
      "name": "OpenRouter Chat Model2",
      "credentials": {
        "openRouterApi": {
          "id": "Nq4FSDBiMwYkReDF",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"store\": true,\n  \"memory_type\": \"state | decision | rule | context | ephemeral\",\n  \"confidence\": 0.0,\n  \"reason\": \"í•œ ë¬¸ì¥ ì„¤ëª…\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        5936,
        1120
      ],
      "id": "d5c5b66e-4b62-411e-9ede-fbfa66502bb8",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"summary\": \"ìš”ì•½ ë¬¸ì¥\",\n  \"decision\": \"ìˆìœ¼ë©´ í•µì‹¬ ê²°ì •\",\n  \"relations\": [\"ìˆìœ¼ë©´ ê´€ê³„ ìš”ì•½\"]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        5584,
        1120
      ],
      "id": "c66f767d-703d-463b-a3fc-e8d7fb21a12e",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ì‚¬ìš©ì ì›ë³¸: {{ $('Webhook').item.json.body.message }}\n\nìš”ì•½ ê²°ê³¼: {{ JSON.stringify($('Memory Summary').item.json.output) }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=ë„ˆëŠ” AI ìˆ˜í•™ íŠœí„°ì˜ í•™ìŠµ ê¸°ì–µ ì €ì¥ íŒë³„ê¸°ì´ë‹¤.\ní•™ìƒì˜ í’€ì´ ê³¼ì •ê³¼ ìš”ì•½ ë‚´ìš©ì„ ë³´ê³ ,\n\"ë‹¤ìŒ ìˆ˜ì—…ì—ì„œ ì´ í•™ìƒì—ê²Œ ë„ì›€ì´ ë  ì •ë³´ì¸ì§€\"ë¥¼ íŒë‹¨í•˜ë¼.\n\n## ì €ì¥ íŒë‹¨ ê¸°ì¤€\n\n### A. ë°˜ë“œì‹œ ì €ì¥ (store: true)\n- í•™ìƒì˜ ë°˜ë³µ ì‹¤ìˆ˜ íŒ¨í„´ (ë¶€í˜¸ ì˜¤ë¥˜, ëŒ€ì… ì‹¤ìˆ˜ ë“±)\n- í•™ìƒì´ ì–´ë ¤ì›Œí•˜ëŠ” ê°œë…/ë‹¨ì›\n- í•™ìƒì˜ í’€ì´ ì „ëµ ì„ í˜¸ (ì¸ìˆ˜ë¶„í•´ vs ê·¼ì˜ê³µì‹)\n- í•™ìƒì˜ ì•½ì  ë³€í™” (ê°œì„  or ì•…í™”)\n\n### B. ì €ì¥ ê¸ˆì§€ (store: false)\n- summaryê°€ ë¹ˆ ë¬¸ìì—´\n- ë¬¸ì œì˜ í’€ì´ ê³¼ì • ìì²´\n- AI íŠœí„°ì˜ ì„¤ëª…/ì œì•ˆ ë‚´ìš©\n- AIê°€ ì‚¬ìš©í•œ ë„êµ¬ ì •ë³´ (Wolfram ì‚¬ìš© ë“±)\n- íŠ¹ì • ë¬¸ì œì˜ ê³„ìˆ˜ ê°’ (a=2, b=5 ê°™ì€ ê²ƒ)\n- í•œ ë²ˆë§Œ ë°œìƒí•œ ë‹¨ìˆœ ê³„ì‚° ì‹¤ìˆ˜\n\n## confidence ê¸°ì¤€\n- 0.9+: 2íšŒ ì´ìƒ ë°˜ë³µëœ ì‹¤ìˆ˜ íŒ¨í„´\n- 0.7~0.9: ëª…í™•í•œ ì•½ì ì´ì§€ë§Œ ì²« ë°œê²¬\n- 0.5~0.7: ì•½ì ì¸ì§€ ë¶ˆí™•ì‹¤\n- 0.5 ë¯¸ë§Œ: ì €ì¥ ë¶ˆí•„ìš”\n\nâš ï¸ ì ˆëŒ€ ê·œì¹™:\n- ë°˜ë“œì‹œ JSONë§Œ ì¶œë ¥í•˜ë¼. ì„¤ëª…, ë§ˆí¬ë‹¤ìš´, ì½”ë“œë¸”ë¡ ê¸ˆì§€.\n- ì €ì¥í•˜ì§€ ì•Šì„ ê²½ìš° ë°˜ë“œì‹œ ì´ JSONì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ë¼:\n{\"store\": false, \"memory_type\": \"ephemeral\", \"confidence\": 0.0, \"reason\": \"ì €ì¥í•  í•™ìŠµ íŒ¨í„´ ì—†ìŒ\"}\n\n## ì¶œë ¥ í˜•ì‹\n{\n  \"store\": true | false,\n  \"memory_type\": \"weakness | pattern | preference | improvement | ephemeral\",\n  \"confidence\": 0.0 ~ 1.0,\n  \"reason\": \"í•œ ë¬¸ì¥ ì„¤ëª…\"\n}"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        5792,
        896
      ],
      "id": "32d043ea-0291-4458-b64e-914227efc7fa",
      "name": "Evaluate"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        5408,
        1120
      ],
      "id": "6825e2de-b2f7-4a82-b581-fb5963411eb9",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "Nq4FSDBiMwYkReDF",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "6d063698-76f8-49a1-980e-0b552e988643",
              "leftValue": "={{ $json.output.store }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            },
            {
              "id": "9099fae6-6cab-47d7-ad52-873f52a1e39b",
              "leftValue": "={{ $json.output.confidence }}",
              "rightValue": 0.7,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        6096,
        896
      ],
      "id": "f59ce1e4-7a9d-49ae-980e-deb615c741ea",
      "name": "If1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolWolframAlpha",
      "typeVersion": 1,
      "position": [
        4608,
        1408
      ],
      "id": "57243892-0d3e-4dc7-9e95-c3d325dd1107",
      "name": "wolfram_calculator",
      "credentials": {
        "wolframAlphaApi": {
          "id": "M3PVRsaoQRl9BepY",
          "name": "WolframAlphaApi account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Run Each Node Once to Set Up Database Tables",
        "height": 508,
        "width": 680,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2336,
        768
      ],
      "typeVersion": 1,
      "id": "abb652c9-1a2b-4d8e-a2f0-2638cef88fa5",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "-- 0) pgvector í™œì„±í™”\ncreate extension if not exists vector;\n\n-- 1) ë¬¸ì œ ì„ë² ë”© í…Œì´ë¸”\ncreate table if not exists documents (\n  id bigserial primary key,\n  content text,\n  metadata jsonb,\n  embedding vector(1536)\n);\n\n-- 2) ìœ ì‚¬ ë¬¸ì œ ê²€ìƒ‰ í•¨ìˆ˜\ncreate or replace function match_documents (\n  query_embedding vector(1536),\n  match_count int default null,\n  filter jsonb DEFAULT '{}'\n) returns table (\n  id bigint,\n  content text,\n  metadata jsonb,\n  similarity float\n)\nlanguage plpgsql\nas $$\n#variable_conflict use_column\nbegin\n  return query\n  select\n    id,\n    content,\n    metadata,\n    1 - (documents.embedding <=> query_embedding) as similarity\n  from documents\n  where metadata @> filter\n  order by documents.embedding <=> query_embedding\n  limit match_count;\nend;\n$$;\n\n-- 3) ë¬¸ì œ ë©”íƒ€ì •ë³´\ncreate table if not exists document_metadata (\n  id text primary key,\n  title text,\n  url text,\n  created_at timestamp default now(),\n  schema text,\n  problem_code text,\n  subject text default 'math',\n  topic text,\n  difficulty text,\n  answer_text text\n);\n\n-- 4) document_rows (Tool í˜¸í™˜ìš©)\ncreate table if not exists document_rows (\n  id serial primary key,\n  dataset_id text references document_metadata(id),\n  row_data jsonb\n);",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        2560,
        976
      ],
      "id": "9f49f32e-124d-4eb9-bbc6-e3757968ee3a",
      "name": "Create Documents Table and Match Function",
      "credentials": {
        "postgres": {
          "id": "QoBh8rnYcTKiyMKF",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Search math problem bank for similar practice problems. MUST be called when recommending exercises to students.",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "topK": 2,
        "options": {
          "queryName": "match_documents"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        4064,
        1408
      ],
      "id": "bc9bcde7-783f-47f3-be55-5baa869fcc4f",
      "name": "Supabase Vector Store",
      "credentials": {
        "supabaseApi": {
          "id": "IRXs1bJdW31d4V7Q",
          "name": "AITUTOR Supabase account"
        }
      }
    },
    {
      "parameters": {
        "model": "text-embedding-ada-002",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        3808,
        1568
      ],
      "id": "516fa916-01b4-4a91-be1b-2841518080cf",
      "name": "Embeddings OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "FHruXiW3PJfYtsIQ",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": "text-embedding-ada-002",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        4016,
        1120
      ],
      "id": "08cf7e68-93f3-4902-a4c7-408795f50418",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "FHruXiW3PJfYtsIQ",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "mode": "load",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "prompt": "={{ $('Webhook').item.json.body.message }}",
        "topK": 2,
        "options": {
          "queryName": "match_documents"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        4080,
        896
      ],
      "id": "5b3b5a92-0f03-4ddf-9e07-ab5d103abaf7",
      "name": "Vector Search",
      "credentials": {
        "supabaseApi": {
          "id": "IRXs1bJdW31d4V7Q",
          "name": "AITUTOR Supabase account"
        }
      }
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "document"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        4432,
        896
      ],
      "id": "15de2564-d7e4-4edc-974b-b7e1c5ce9437",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook').item.json.body.user_id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        4752,
        1408
      ],
      "id": "c305b398-cc35-442e-a486-901b30f86112",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT a.id as assignment_id, a.exam_content, s.id as submission_id\nFROM student_submissions s\nJOIN teacher_assignments a ON s.assignment_id = a.id\nWHERE s.student_id = '{{ $('Webhook').first().json.body.user_id }}'\nAND s.status = 'pending'\nAND a.status = 'active'\nORDER BY a.created_at DESC\nLIMIT 1",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        3328,
        880
      ],
      "id": "66b83ff4-4533-4c53-add5-874f0c12da71",
      "name": "Check Assignment",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "e7fdfb7c-1722-41e3-98b7-ef75b5ead899",
              "leftValue": "={{ $('Check Assignment').first().json.assignment_id }}",
              "rightValue": "",
              "operator": {
                "type": "number",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3536,
        880
      ],
      "id": "69c58cee-06c0-4166-8397-a5de07a69755",
      "name": "Has Assignment?"
    },
    {
      "parameters": {
        "jsCode": "const mem0 = $('Assignment Mem0 Search').first().json;\nconst assignment = $('Check Assignment').first().json;\nconst userMessage = $('Webhook').first().json.body.message;\n\nreturn [{\n  json: {\n    mem0: JSON.stringify(mem0),\n    exam_content: assignment.exam_content,\n    assignment_id: assignment.assignment_id,\n    submission_id: assignment.submission_id,\n    user_message: userMessage\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4064,
        560
      ],
      "id": "b2f15ca6-d4d3-4eb6-9cd3-6bf2b55943d4",
      "name": "Assignment Merge"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://193.168.195.222:8888/search",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"query\": \"í•™ìƒ í•™ìŠµ ìƒíƒœ ì•½ì  ê°•ì \",\n  \"user_id\": \"{{ $('Webhook').first().json.body.user_id }}\",\n  \"limit\": 10\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3856,
        560
      ],
      "id": "6b4f1491-5be8-4642-8235-77334750204e",
      "name": "Assignment Mem0 Search"
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {}
      },
      "id": "a4192515-7947-4733-927c-05148098c2d0",
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1,
      "position": [
        4432,
        736
      ],
      "credentials": {
        "openAiApi": {
          "id": "FHruXiW3PJfYtsIQ",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook').item.json.body.user_id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        4640,
        736
      ],
      "id": "8f0e8555-4aec-4f11-bc65-48121d76a7ac",
      "name": "Postgres Chat Memory1",
      "credentials": {
        "postgres": {
          "id": "uN9QWmdYp4HSiR7V",
          "name": "AITUTOR Postgres account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Webhook').item.json.body.message }}",
        "options": {
          "systemMessage": "=ë„ˆëŠ” ê³ ë“±í•™êµ ìˆ˜í•™ ê³¼ì œ ê°ë…ê´€ì´ì•¼. í•™ìƒì´ ìŠ¤ìŠ¤ë¡œ ë¬¸ì œë¥¼ í’€ë„ë¡ ë•ëŠ” ì—­í• ì´ì•¼.\n\n## ì ˆëŒ€ ê·œì¹™ (ìœ„ë°˜ ê¸ˆì§€)\n- ì •ë‹µ(ìˆ«ì, xê°’, ìµœì¢… ë‹µ)ì„ ì ˆëŒ€ ë§í•˜ì§€ ë§ˆ.\n- ì „ì²´ í’€ì´ ê³¼ì •ì„ ì ˆëŒ€ ë³´ì—¬ì£¼ì§€ ë§ˆ.\n- í•œ ë²ˆì— í•œ ë‹¨ê³„ íŒíŠ¸ë§Œ ì œê³µí•´.\n- \"ëª¨ë¥´ê² ì–´\", \"ëª» í’€ê² ì–´\"ì—ë„ í’€ì´ë¥¼ ì œê³µí•˜ì§€ ë§ˆ. ë” ì‰¬ìš´ íŒíŠ¸ë¥¼ ì¤˜.\n\n## í—ˆìš©ë˜ëŠ” ê²ƒ\n- \"ì´ ë¬¸ì œëŠ” ì¸ìˆ˜ë¶„í•´ë¡œ í’€ ìˆ˜ ìˆì–´\" (ë°©ë²• ì œì‹œ)\n- \"ê³±ì´ -10ì´ê³  í•©ì´ 3ì¸ ë‘ ìˆ˜ë¥¼ ì°¾ì•„ë´\" (í•œ ë‹¨ê³„ íŒíŠ¸)\n- \"íŒë³„ì‹ ê³µì‹ì´ ë­ì˜€ì§€?\" (ê°œë… ì§ˆë¬¸ìœ¼ë¡œ ìœ ë„)\n- í•™ìƒì´ ë‹µì„ ë§í•˜ë©´ ë§ì•˜ëŠ”ì§€/í‹€ë ¸ëŠ”ì§€ë§Œ ì•Œë ¤ì£¼ê¸°\n\n## ê¸ˆì§€ë˜ëŠ” ê²ƒ (ì˜ˆì‹œ)\n- \"x = -5, x = 2ê°€ ì •ë‹µì´ì•¼\" â† ì ˆëŒ€ ê¸ˆì§€\n- \"3x + 10 = 2x + 20, x = 10\" â† í’€ì´ ê³¼ì • ê¸ˆì§€\n- 4ë‹¨ê³„ í’€ì´ ì „ì²´ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒ â† ê¸ˆì§€\n\n## íŒíŠ¸ ë‹¨ê³„\n1ë‹¨ê³„: í’€ì´ ë°©ë²•ë§Œ ì œì‹œ (\"ì¸ìˆ˜ë¶„í•´ í•´ë³¼ê¹Œ?\")\n2ë‹¨ê³„: êµ¬ì²´ì  ë°©í–¥ (\"ë‘ ìˆ˜ì˜ ê³±ì´ -10ì´ ë˜ëŠ” ì¡°í•©ì„ ì°¾ì•„ë´\")\n3ë‹¨ê³„: ë” êµ¬ì²´ì  (\"ì–‘ìˆ˜ì™€ ìŒìˆ˜ ì¡°í•©ì„ ìƒê°í•´ë´. 5ì™€ ?\")\n4ë‹¨ê³„ ì´ìƒ: í•™ìƒì´ ëª…í™•íˆ í¬ê¸° ì„ ì–¸ ì‹œì—ë§Œ í’€ì´ ì œê³µ\n\n## í•™ìƒ Mem0 ë°ì´í„°\n{{ $json.mem0 }}\n\n## ì„ ìƒë‹˜ì´ ë‚´ì¤€ ê³¼ì œ\n{{ $json.exam_content }}\n\n## ì§„í–‰ ë°©ì‹\n- ì²« ë©”ì‹œì§€ë©´: \"ì„ ìƒë‹˜ì´ ê³¼ì œë¥¼ ë‚´ì¤¬ì–´! ê°™ì´ í’€ì–´ë³´ì ğŸ˜Š\" + ë¬¸ì œ 1ë²ˆ ì œì‹œ\n- í•™ìƒ ë‹µë³€ â†’ ë§ìœ¼ë©´ ì¹­ì°¬ + ë‹¤ìŒ ë¬¸ì œ / í‹€ë¦¬ë©´ ì–´ë””ê°€ í‹€ë ¸ëŠ”ì§€ íŒíŠ¸\n- ì ˆëŒ€ í•œ ë²ˆì— ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ë³´ì—¬ì£¼ì§€ ë§ˆ\n\n## ìˆ˜ì‹ í‘œê¸°\nLaTeX ìˆ˜ì‹ì€ $...$ (ì¸ë¼ì¸) ë˜ëŠ” $$...$$ (ë¸”ë¡) í˜•ì‹."
        }
      },
      "id": "40944284-3f35-4c69-b338-82368a06880f",
      "name": "Assignment Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.6,
      "position": [
        4640,
        560
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Check Assignment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RAG AI Agent": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Documents": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get File Contents": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Execute SQL": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "List Tables": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get Table Schema": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Mem0 Search": {
      "main": [
        [
          {
            "node": "Vector Search",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Memory Summary": {
      "main": [
        [
          {
            "node": "Evaluate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "Evaluate",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Evaluate",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Memory Summary",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Evaluate": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Memory Summary",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Mem0 Add",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook": {
      "main": [
        [
          {
            "node": "Memory Summary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "wolfram_calculator": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create Documents Table and Match Function": {
      "main": [
        []
      ]
    },
    "Embeddings OpenAI1": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Supabase Vector Store": {
      "ai_tool": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Vector Search",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Vector Search": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "RAG AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "RAG AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Check Assignment": {
      "main": [
        [
          {
            "node": "Has Assignment?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Assignment?": {
      "main": [
        [
          {
            "node": "Assignment Mem0 Search",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mem0 Search",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Assignment Mem0 Search": {
      "main": [
        [
          {
            "node": "Assignment Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Assignment Merge": {
      "main": [
        [
          {
            "node": "Assignment Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Assignment Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory1": {
      "ai_memory": [
        [
          {
            "node": "Assignment Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Assignment Agent": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "52754da4-ca08-49f3-ab84-79490a6790ea",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "f25b64f8e08bc6b0af3e5071d97899510fcb40c11931589423f85ff4c37333c1"
  },
  "id": "coYBpkDFV8739J8I",
  "tags": []
}